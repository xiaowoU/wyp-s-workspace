<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.11&key=lqa7E19BuMACUHqXf9u3ogZIO6wBTYN&plugin=AMap.DistrictSearch"></script>
		<script>
			this.opts = {
			    subdistrict: 1,   //返回下一级行政区
			    showbiz: false  //最后一级返回街道信息
			};
			this.district = new AMap.DistrictSearch(this.opts);//注意：需要使用插件同步下发功能才能这样直接使用
			this.district.search('中国', (status, result) => {
			    if (status == 'complete') {
			        this.getData(result.districtList[0], '', 100000);
			    }
			});
			getData(data, level, adcode) {//处理获取出来的边界数据
			    var subList = data.districtList;
			    if (subList) {
			        var curlevel = subList[0].level;
			        if (curlevel === 'street') {//为了配合echarts地图区县名称显示正常，这边街道级别数据需要特殊处理
			            let mapJsonList = this.geoJsonData.features;
			            let mapJson = {};
			            for (let i in mapJsonList) {
			                if (mapJsonList[i].properties.name == this.cityName) {
			                    mapJson.features = [].concat(mapJsonList[i]);
			                }
			            }
			            this.mapData = [];
			            //这个mapData里包含每个区域的code、名称、对应的等级，实现第三步功能时能用上
			            this.mapData.push({name: this.cityName, value: Math.random() * 100, level: curlevel});
			            this.loadMap(this.cityName, mapJson);
			            this.geoJsonData = mapJson;
			            return;
			        }
			       
			        //街道级以上的数据处理方式
			        this.mapData = [];
			        for (var i = 0, l = subList.length; i < l; i++) {
			            var name = subList[i].name;
			            var cityCode = subList[i].adcode;
			            //这个mapData里包含每个区域的code、名称、对应的等级，实现第三步功能时能用上
			            this.mapData.push({
			                name: name,
			                value: Math.random() * 100,
			                cityCode: cityCode,
			                level: curlevel
			            });
			        }
			        this.loadMapData(adcode);
			    }
			},
						
		</script>
	</body>
</html>
